import{b9 as B,af as se,aU as de,ae as M,ag as re,ba as oe,aH as ve,aW as pe,aJ as Ee,bb as me,N as L,a1 as G,O as R,b as Te,k as F,d as be,z as ge,l as w,f as T,G as he,V as W,P as Fe}from"./index-70c8f837.js";import{_ as ye}from"./base-21f85690.js";import{E as ae}from"./typescript-ac073a9a.js";function Pe(e){return e}function Se(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}var _e=800,we=16,Oe=Date.now;function Ce(e){var t=0,n=0;return function(){var s=Oe(),r=we-(s-n);if(n=s,r>0){if(++t>=_e)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}function Le(e){return function(){return e}}var Re=B?function(e,t){return B(e,"toString",{configurable:!0,enumerable:!1,value:Le(t),writable:!0})}:Pe;const Ae=Re;var Ie=Ce(Ae);const Ne=Ie;var q=Math.max;function ke(e,t,n){return t=q(t===void 0?e.length-1:t,0),function(){for(var s=arguments,r=-1,a=q(s.length-t,0),c=Array(a);++r<a;)c[r]=s[t+r];r=-1;for(var i=Array(t+1);++r<t;)i[r]=s[r];return i[t]=n(c),Se(e,this,i)}}var Ue=9007199254740991;function xe(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=Ue}var Ke="[object Arguments]";function z(e){return se(e)&&de(e)==Ke}var ue=Object.prototype,De=ue.hasOwnProperty,He=ue.propertyIsEnumerable,$e=z(function(){return arguments}())?z:function(e){return se(e)&&De.call(e,"callee")&&!He.call(e,"callee")};const ce=$e;function Ve(e,t){for(var n=-1,s=t.length,r=e.length;++n<s;)e[r+n]=t[n];return e}var J=M?M.isConcatSpreadable:void 0;function Be(e){return re(e)||ce(e)||!!(J&&e&&e[J])}function ie(e,t,n,s,r){var a=-1,c=e.length;for(n||(n=Be),r||(r=[]);++a<c;){var i=e[a];t>0&&n(i)?t>1?ie(i,t-1,n,s,r):Ve(r,i):s||(r[r.length]=i)}return r}function Me(e){var t=e==null?0:e.length;return t?ie(e,1):[]}function Ge(e){return Ne(ke(e,void 0,Me),e+"")}function We(e,t){return e!=null&&t in Object(e)}function qe(e,t,n){t=oe(t,e);for(var s=-1,r=t.length,a=!1;++s<r;){var c=ve(t[s]);if(!(a=e!=null&&n(e,c)))break;e=e[c]}return a||++s!=r?a:(r=e==null?0:e.length,!!r&&xe(r)&&pe(c,r)&&(re(e)||ce(e)))}function ze(e,t){return e!=null&&qe(e,t,We)}function Je(e){return e==null}function Tt(e){return e===void 0}function Xe(e,t,n){for(var s=-1,r=t.length,a={};++s<r;){var c=t[s],i=Ee(e,c);n(i,c)&&me(a,oe(c,e),i)}return a}function Ye(e,t){return Xe(e,t,function(n,s){return ze(e,s)})}var Qe=Ge(function(e,t){return e==null?{}:Ye(e,t)});const Ze=Qe;let E=[];const X=e=>{const t=e;t.key===ae.esc&&E.forEach(n=>n(t))},je=e=>{L(()=>{E.length===0&&document.addEventListener("keydown",X),G&&E.push(e)}),R(()=>{E=E.filter(t=>t!==e),E.length===0&&G&&document.removeEventListener("keydown",X)})},et=Te({ariaLabel:String,ariaOrientation:{type:String,values:["horizontal","vertical","undefined"]},ariaControls:String}),bt=e=>Ze(et,e),O="focus-trap.focus-after-trapped",C="focus-trap.focus-after-released",tt="focus-trap.focusout-prevented",Y={cancelable:!0,bubbles:!1},nt={cancelable:!0,bubbles:!1},Q="focusAfterTrapped",Z="focusAfterReleased",st=Symbol("elFocusTrap"),A=F(),y=F(0),I=F(0);let b=0;const fe=e=>{const t=[],n=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:s=>{const r=s.tagName==="INPUT"&&s.type==="hidden";return s.disabled||s.hidden||r?NodeFilter.FILTER_SKIP:s.tabIndex>=0||s===document.activeElement?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)t.push(n.currentNode);return t},j=(e,t)=>{for(const n of e)if(!rt(n,t))return n},rt=(e,t)=>{if(getComputedStyle(e).visibility==="hidden")return!0;for(;e;){if(t&&e===t)return!1;if(getComputedStyle(e).display==="none")return!0;e=e.parentElement}return!1},ot=e=>{const t=fe(e),n=j(t,e),s=j(t.reverse(),e);return[n,s]},at=e=>e instanceof HTMLInputElement&&"select"in e,p=(e,t)=>{if(e&&e.focus){const n=document.activeElement;e.focus({preventScroll:!0}),I.value=window.performance.now(),e!==n&&at(e)&&t&&e.select()}};function ee(e,t){const n=[...e],s=e.indexOf(t);return s!==-1&&n.splice(s,1),n}const ut=()=>{let e=[];return{push:s=>{const r=e[0];r&&s!==r&&r.pause(),e=ee(e,s),e.unshift(s)},remove:s=>{var r,a;e=ee(e,s),(a=(r=e[0])==null?void 0:r.resume)==null||a.call(r)}}},ct=(e,t=!1)=>{const n=document.activeElement;for(const s of e)if(p(s,t),document.activeElement!==n)return},te=ut(),it=()=>y.value>I.value,g=()=>{A.value="pointer",y.value=window.performance.now()},ne=()=>{A.value="keyboard",y.value=window.performance.now()},ft=()=>(L(()=>{b===0&&(document.addEventListener("mousedown",g),document.addEventListener("touchstart",g),document.addEventListener("keydown",ne)),b++}),R(()=>{b--,b<=0&&(document.removeEventListener("mousedown",g),document.removeEventListener("touchstart",g),document.removeEventListener("keydown",ne))}),{focusReason:A,lastUserFocusTimestamp:y,lastAutomatedFocusTimestamp:I}),h=e=>new CustomEvent(tt,{...nt,detail:e}),lt=be({name:"ElFocusTrap",inheritAttrs:!1,props:{loop:Boolean,trapped:Boolean,focusTrapEl:Object,focusStartEl:{type:[Object,String],default:"first"}},emits:[Q,Z,"focusin","focusout","focusout-prevented","release-requested"],setup(e,{emit:t}){const n=F();let s,r;const{focusReason:a}=ft();je(o=>{e.trapped&&!c.paused&&t("release-requested",o)});const c={paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}},i=o=>{if(!e.loop&&!e.trapped||c.paused)return;const{key:u,altKey:f,ctrlKey:l,metaKey:d,currentTarget:H,shiftKey:$}=o,{loop:V}=e,le=u===ae.tab&&!f&&!l&&!d,m=document.activeElement;if(le&&m){const P=H,[S,_]=ot(P);if(S&&_){if(!$&&m===_){const v=h({focusReason:a.value});t("focusout-prevented",v),v.defaultPrevented||(o.preventDefault(),V&&p(S,!0))}else if($&&[S,P].includes(m)){const v=h({focusReason:a.value});t("focusout-prevented",v),v.defaultPrevented||(o.preventDefault(),V&&p(_,!0))}}else if(m===P){const v=h({focusReason:a.value});t("focusout-prevented",v),v.defaultPrevented||o.preventDefault()}}};ge(st,{focusTrapRef:n,onKeydown:i}),w(()=>e.focusTrapEl,o=>{o&&(n.value=o)},{immediate:!0}),w([n],([o],[u])=>{o&&(o.addEventListener("keydown",i),o.addEventListener("focusin",U),o.addEventListener("focusout",x)),u&&(u.removeEventListener("keydown",i),u.removeEventListener("focusin",U),u.removeEventListener("focusout",x))});const N=o=>{t(Q,o)},k=o=>t(Z,o),U=o=>{const u=T(n);if(!u)return;const f=o.target,l=o.relatedTarget,d=f&&u.contains(f);e.trapped||l&&u.contains(l)||(s=l),d&&t("focusin",o),!c.paused&&e.trapped&&(d?r=f:p(r,!0))},x=o=>{const u=T(n);if(!(c.paused||!u))if(e.trapped){const f=o.relatedTarget;!Je(f)&&!u.contains(f)&&setTimeout(()=>{if(!c.paused&&e.trapped){const l=h({focusReason:a.value});t("focusout-prevented",l),l.defaultPrevented||p(r,!0)}},0)}else{const f=o.target;f&&u.contains(f)||t("focusout",o)}};async function K(){await W();const o=T(n);if(o){te.push(c);const u=o.contains(document.activeElement)?s:document.activeElement;if(s=u,!o.contains(u)){const l=new Event(O,Y);o.addEventListener(O,N),o.dispatchEvent(l),l.defaultPrevented||W(()=>{let d=e.focusStartEl;Fe(d)||(p(d),document.activeElement!==d&&(d="first")),d==="first"&&ct(fe(o),!0),(document.activeElement===u||d==="container")&&p(o)})}}}function D(){const o=T(n);if(o){o.removeEventListener(O,N);const u=new CustomEvent(C,{...Y,detail:{focusReason:a.value}});o.addEventListener(C,k),o.dispatchEvent(u),!u.defaultPrevented&&(a.value=="keyboard"||!it()||o.contains(document.activeElement))&&p(s??document.body),o.removeEventListener(C,k),te.remove(c)}}return L(()=>{e.trapped&&K(),w(()=>e.trapped,o=>{o?K():D()})}),R(()=>{e.trapped&&D()}),{onKeydown:i}}});function dt(e,t,n,s,r,a){return he(e.$slots,"default",{handleKeydown:e.onKeydown})}var gt=ye(lt,[["render",dt],["__file","focus-trap.vue"]]);export{gt as E,st as F,Tt as a,Ve as b,Pe as c,xe as d,ce as e,ze as h,Je as i,bt as u};
